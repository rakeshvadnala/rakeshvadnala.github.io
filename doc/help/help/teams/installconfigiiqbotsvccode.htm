<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_SP__Side_Nav" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="Online">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Installing and Configuring the IdentityIQ Service Code</title>
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../zresources/tablestyles/breadcrumb_table.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/arrow-left.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/arrow-right.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/icon-print-gray.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../zresources/stylesheets/iiq_stylesheet.css" rel="stylesheet" type="text/css" />
        <script src="../resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-device-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../iiqlandingpage.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../zresources/tablestyles/breadcrumb_table.css');" class="TableStyle-Breadcrumb_Table" cellspacing="0">
                                        <col class="TableStyle-Breadcrumb_Table-Column-Column1" />
                                        <col class="TableStyle-Breadcrumb_Table-Column-Column1" />
                                        <tbody>
                                            <tr class="TableStyle-Breadcrumb_Table-Body-Body1">
                                                <td class="TableStyle-Breadcrumb_Table-BodyB-Column1-Body1">
                                                    <div class="nocontent">
                                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="{title} topic link" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td class="TableStyle-Breadcrumb_Table-BodyA-Column1-Body1">
                                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent" style="mc-topic-toolbar-items: ;text-align: right;">
                                                        <div class="button-group-container-left">
                                                            <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                                <img alt="Navigate previous" src="../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                            </button>
                                                            <button class="button needs-pie next-topic-button" title="Navigate next">
                                                                <img alt="Navigate next" src="../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                            </button>
                                                            <button class="button needs-pie print-button" title="Print">
                                                                <img alt="Print" src="../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                            </button>
                                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                                <img alt="Expand all" src="../Skins/Default/Stylesheets/Images/transparent.gif" class="invisible-label" />
                                                            </button>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <div role="main" id="mc-main-content">
                                        <h1>Installing and Configuring the IdentityIQ Service Code</h1>
                                        <p>The IdentityIQ&#160;service code is provided by SailPoint. The service code is packaged into platform-specific zip files and is downloaded from <a href="https://community.sailpoint.com/">Compass</a>. Choose the zip file appropriate for your platform.</p>
                                        <p> The Linux zip file includes an executable file, an env.template file, and a shell script and service script to assist with installing the code as a service.</p>
                                        <p> The Windows zip file contains an executable file and an <code>env.template</code> file. </p>
                                        <p>Once you have downloaded the zip appropriate to your environment, follow these steps:</p>
                                        <ol>
                                            <li value="1">
                                                <p>Extract the zip to the private server dedicated to hosting the service code. See the section on <a href="prereqsteams.htm" class="MCXref xref">Prerequisites for Integrating  Microsoft Teams with IdentityIQ</a> for more information.</p>
                                            </li>
                                            <li value="2">
                                                <p>The zip file includes a template for configuring your IdentityIQ/Microsoft Teams environment, named <code>template.env</code>. Copy this file and name it <code>.env</code>.</p>
                                            </li>
                                            <li value="3">
                                                <p>Edit the <code>.env</code> file to set configuration values for your environment. The values you <i>must</i> configure are listed below; some other  values can be modified as needed for your environment. The variables in the file are commented, to give you information on their usage.</p>
                                                <ul>
                                                    <li>
                                                        <p><code>PUBLIC_HOSTNAME=&lt;public DNS hostname&gt;:&#160;</code>the public domain name of where you host the IdentityIQ&#160;service code. This must be a public DNS-resolvable hostname that resolves  to the private IP of the server that will run the service code.  The traffic can be limited to a specific port, which is customizable.  See <a href="prereqsteams.htm" class="MCXref xref">Prerequisites for Integrating  Microsoft Teams with IdentityIQ</a>. </p>
                                                    </li>
                                                    <li>
                                                        <p><code>LOCAL_HOSTNAME=&lt;local private IP address&gt;</code>:&#160;this is the private IP to which the <code>PUBLIC_HOSTNAME</code>  is routed. </p>
                                                    </li>
                                                    <li>
                                                        <p><code>PUBLIC_PORT</code>&#160;and <code>PRIVATE_PORT</code>:&#160;the hosting ports for the IdentityIQ&#160;service code.&#160;The template provides default values which can be replaced with values specific to your installation. See the <b>Connectivity and Security Prerequisites</b> section in <a href="prereqsteams.htm" class="MCXref xref">Prerequisites for Integrating  Microsoft Teams with IdentityIQ</a>. </p>
                                                    </li>
                                                    <li>
                                                        <p><code>TENANT_ID=&lt;Azure tenant ID&gt;</code>:&#160;your Azure tenant ID. </p>
                                                    </li>
                                                    <li>
                                                        <p><code>APP_ID=&lt;teams app ID&gt;</code>: the Application (client) ID value that was set as part of configuring  the Microsoft Teams app. You can find this value on the Overview page of the Microsoft Teams app. See <a href="createteamsappinazure.htm" class="MCXref xref">Creating a Microsoft Teams Application for IdentityIQ in Azure</a></p>
                                                    </li>
                                                    <li>
                                                        <p><code>APP_NAME=&lt;teams app name&gt;:</code>&#160; the name of your Microsoft Teams app. See <a href="createteamsappinazure.htm" class="MCXref xref">Creating a Microsoft Teams Application for IdentityIQ in Azure</a></p>
                                                    </li>
                                                    <li>
                                                        <p><code>APP_SECRET=&lt;encrypted teams app secret&gt;</code>:&#160;<b>IMPORTANT</b>:&#160;this value is required but will be set later, in a secondary step. See the <a href="#Encrypt" class="MCXref xref">Encrypt and add your client secret to the environment file. For convenience, the IdentityIQ service code provides an encryption endpoint. </a> below.</p>
                                                    </li>
                                                    <li>
                                                        <p><code>SSO_CONNECTION_NAME=&lt;sso connection associated with azure bot&gt;</code>:&#160;this&#160;value was set in the <b>Add OAuth Connection Settings</b> when you configured the Azure bot. See <a href="createbotinazure.htm" class="MCXref xref">Creating an Azure Bot for IdentityIQ's Microsoft Teams Notifications</a>.</p>
                                                    </li>
                                                    <li>
                                                        <p><code>ENCRYPTION_SECRET=&lt;provide strong value&gt;</code>:&#160;provide an 8-character encryption secret. This can be any value you like, but if this value changes, any items encrypted must be re-encrypted</p>
                                                    </li>
                                                    <li>
                                                        <p><code>IIQ_URL</code>: the full URL to your installation of IdentityIQ. Use the format: <code>https://&lt;host/ip&gt;:&lt;port&gt;/&lt;<i>identityiq_home</i>&gt;</code> , where <code>&lt;<i>identityiq_home</i>&gt;</code> is the directory in which you extracted the identityiq.war file during the IdentityIQ installation procedure. If you are using a load balancer to manage multiple IdentityIQ hosts, put the load balancer URL here.</p>
                                                    </li>
                                                    <li>
                                                        <p><code>IIQ_PORT=&lt;port to which IIQ server listens&gt;</code>:&#160;the port for your IdentityIQ&#160;server. If you are using a load balancer to manage multiple IdentityIQ hosts, put the load balancer port here. </p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li value="4">
                                                <p>Install valid certificate files in the <code>cert</code> directory contained in the root location where your extracted service code and .<code>env</code> file are.&#160;The certificate must be named <code>bot.cert</code> and the key must be named <code>bot.key</code>. The service code can work on encrypted or raw certificates, but for security reasons, it is recommended to encrypt them.  For convenience, an encrypt endpoint has been provided with the service code. Make sure the <code>cert </code>directory, the <code>bot.cert</code> and the <code>bot.key</code> items are set with <code>rw </code>permission for owner only. For more information on certificates, see <a href="prereqsteams.htm" class="MCXref xref">Prerequisites for Integrating  Microsoft Teams with IdentityIQ</a>.</p>
                                            </li>
                                            <li value="5">
                                                <p><a name="Encrypt"></a>Encrypt and add your client secret to the environment file. For convenience, the IdentityIQ service code provides an encryption endpoint. </p>
                                                <ol style="list-style-type: lower-alpha;">
                                                    <li value="1">
                                                        <p>Make sure rest of the <code>.env</code> file has been configured and saved before encrypting and adding the client secret.</p>
                                                    </li>
                                                    <li value="2">
                                                        <p>Start the bot (for example, by running the <code>identityiqbot.sh</code> script). Note that because the secret has not yet been encrypted, <b>you may see an error when initially starting the bot.</b> You can continue past this error to complete the process for encrypting the secret.</p>
                                                    </li>
                                                    <li value="3">
                                                        <p>Use the following private POST endpoint to encrypt messages such as bot secret, certificate, and private key.  Provide a JSON object as the payload and a JSON object will be returned with the encrypted value.</p><pre>https://&lt;private IP&gt;:&lt;private port&gt;/util/encrypt</pre><pre>Input: {“message” : “some message to be encrypted”}</pre><pre>Output: { “status” : “success”, “encrypted_message” : “……..”}</pre>
                                                    </li>
                                                    <li value="4">
                                                        <p>Copy the returned value into the  <code>APP_SECRET=&lt;encrypted teams app secret&gt;</code> field of the <code>.env</code> file.</p>
                                                    </li>
                                                    <li value="5">
                                                        <p>Restart the bot.</p>
                                                    </li>
                                                </ol>
                                            </li>
                                            <li value="6">
                                                <p>Add a <code>BOT_HOME</code>&#160;environment variable to this server, set to the directory where your environment file and <code>cert</code> directory are located. </p>
                                            </li>
                                        </ol>
                                        <h2>Allowing Microsoft Teams Users to Disable Notifications</h2>
                                        <p>The <code>ALLOW_USER_TO_DISABLE_NOTIFICATIONS</code> property in the <code>.env</code> file allows Microsoft Teams users to disable notifications, by entering the command <i>nonotifications</i> in their Microsoft Teams environment. This option is disabled by default; if you want to allow users to disable notifications, set this value to <code>true</code>. </p>
                                        <p>&#160;</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>